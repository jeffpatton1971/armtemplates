{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "2019.04.01.0",
  "parameters": {
    "Name": {
      "type": "string",
      "metadata": {
        "description": "The name of the NSG to update"
      }
    },
    "DestinationPrefix": {
      "type": "string",
      "metadata": {
        "description": "The CIDR of the subnet this NSG is attached to"
      }
    }
  },
  "variables": {
    "rackspaceBastionDFW": "172.99.99.10/32",
    "rackspaceBastionIAD": "146.20.2.10/32",
    "rackspaceBastionORD": "161.47.0.10/32",
    "rackspaceBastionHKG": "119.9.122.10/32",
    "rackspaceBastionLON": "134.213.179.10/32",
    "rackspaceBastionLON5": "134.213.178.10/32",
    "rackspaceBastionSYD": "119.9.148.10/32",
    "rackspacepBastionDFW": "72.3.186.100/32",
    "rackspacepBastionIAD": "146.20.30.100/32",
    "rackspacepBastionORD": "161.47.6.100/32",
    "rackspacepBastionHKG": "120.136.39.100/32",
    "rackspacepBastionLON": "134.213.183.100/32",
    "rackspacepBastionLON5": "134.213.182.100/32",
    "rackspacepBastionSYD": "119.9.163.100/32"
  },
  "resources": [
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_DFW')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionDFW')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 151,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_IAD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionIAD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 152,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_ORD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionORD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 153,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_HKG')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionHKG')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 154,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_LON')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionLON')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 155,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_LON5')]",
      "location": "[resourceGroup().location]",

      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionLON5')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 156,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_SYD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspaceBastionSYD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 157,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PDFW')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionDFW')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 179,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PIAD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionIAD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 183,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PORD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionORD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 187,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PHKG')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionHKG')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 191,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PLON')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionLON')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 195,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PLON5')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionLON5')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 199,
        "direction": "Inbound"
      }
    },
    {
      "apiVersion": "2016-03-30",
      "type": "Microsoft.Network/networkSecurityGroups/securityRules",
      "name": "[concat(parameters('Name'),'/Allow_RAX_SSH_PSYD')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "description": "Allows SSH",
        "protocol": "Tcp",
        "sourcePortRange": "*",
        "destinationPortRange": "22",
        "sourceAddressPrefix": "[variables('rackspacepBastionSYD')]",
        "destinationAddressPrefix": "[parameters('DestinationPrefix')]",
        "access": "Allow",
        "priority": 203,
        "direction": "Inbound"
      }
    }
  ],
  "outputs": {
  }
}